{"title":"Las páginas web más visitadas","markdown":{"yaml":{"title":"Las páginas web más visitadas","description":"Viendo qué páginas web son las más visitadas, de qué categoría son y de dónde proceden\n","author":[{"name":"Adeline Baillifard (baillifa@alumni.uv.es)","affiliation":"Universitat de València","affiliation-url":"https://www.uv.es"}],"date":"2023-01-13","categories":["trabajo BigData"],"title-block-banner":false,"title-block-banner-color":"#FFFFFF","toc":true,"toc-location":"left","toc-depth":3,"smooth-scroll":true,"format":{"html":{"link-external-newwindow":true,"backgroundcolor":"#f2f7f6","embed-resources":true}}},"headingText":"Introducción","containsRefs":false,"markdown":"\n\nMi trabajo se divide en 3 partes: \n\n- una lista de las páginas web más visitadas\n- las categorías y subcategorías de las páginas web más visitadas\n- los países de origen de las páginas web más visitadas\n\n## Datos\n\nLos datos vienen de <https://www.kaggle.com/>, plataforma web para concursos de ciencia de datos.\n\n```{r}\n#| code-fold: true\n\n#Datos\ndatos <- rio::import(\"./datos/df_1.csv\") \ncolnames(datos) <- as.character(datos[1,])\ndatos <- datos[-1,]\nnames(datos)[names(datos) == \"NA\"] <- \"Position\"\nnames(datos)[names(datos) == \"Principal country/territory\"] <- \"Country\"\ndatos$Position = datos$Position +1\n\n#Paquetes utilizados\nlibrary(readr)\nlibrary(dplyr)\nlibrary(tidyverse)\nlibrary(plotly)\nlibrary(knitr)\nlibrary(gganimate)\nlibrary(ggplot2)\nlibrary(forcats)\nlibrary(gt)\nlibrary(gtExtras)\nlibrary(tmap)\nlibrary(sf)\nlibrary(maps)\nlibrary(mapdata)\nlibrary(highcharter)\n\n```\n\n# Lista de las páginas web más visitadas\n\nPara empezar, veamos las páginas web más visitadas mediante una lista.\n\n```{r}\n#| code-fold: true\n\n  \ndatos_1 <- datos %>% select (Position, Site, \"Domain Name\", Country)\n\n\n\ndatos_1 <- datos_1 %>%\n  mutate(Country = case_when(\n    str_detect(Country,'United States') ~ \"https://raw.githubusercontent.com/BjnNowak/TdF/main/us.png\",\n    str_detect(Country,'China') ~ 'https://cdn-icons-png.flaticon.com/512/197/197375.png',\n    str_detect(Country,'Russia') ~ 'https://cdn-icons-png.flaticon.com/512/197/197408.png',\n    str_detect(Country,'Czech Republic') ~ 'https://cdn-icons-png.flaticon.com/512/8363/8363183.png',\n    str_detect(Country,'Canada') ~ 'https://cdn-icons-png.flaticon.com/512/197/197430.png',\n    str_detect(Country,'France') ~ 'https://raw.githubusercontent.com/BjnNowak/TdF/main/fr.png',\n    str_detect(Country,'Japan') ~ 'https://cdn-icons-png.flaticon.com/512/197/197604.png',\n    str_detect(Country,'South Korea') ~ 'https://cdn-icons-png.flaticon.com/512/197/197582.png',\n    str_detect(Country,'Cyprus') ~ 'https://cdn-icons-png.flaticon.com/512/4854/4854941.png',\n    str_detect(Country,'Brazil') ~ 'https://cdn-icons-png.flaticon.com/512/197/197386.png',\n    str_detect(Country,'Netherlands') ~ 'https://cdn-icons-png.flaticon.com/512/6157/6157397.png'\n  ))\n\n\ntab_1 <- datos_1 %>% \n  gt(rowname_col = \"Position\") %>% \n  tab_stubhead(label = md(\"**Position**\"))\n\ntab_1 <- tab_1 %>%\n  tab_header(title = md(\"**Páginas Web más visitadas**\"),\n                      subtitle = md(\"en orden\")) %>%\n  gtExtras::gt_img_rows(columns = Country, height = 30)\n\ntab_1 <- tab_1 %>%\n  tab_style(\n    # Select object to modify\n    locations = cells_title(groups = 'title'),\n    # Specify text style\n    style = list(\n      cell_text(\n        font=google_font(name = 'Bebas Neue'), \n        size='xx-large',\n        color='DarkCyan'\n  )))\n\ntab_1\n```\n\n# Categorías de las páginas web más visitadas\n\n## Categorías\n\n```{r}\n#| code-fold: true\ndatos[datos == \"Computers Electronics and Technology > Search Engines\"] <- \"Computers Electronics and Technology\"\ndatos[datos == \"Computers Electronics and Technology > Email\"] <- \"Computers Electronics and Technology\"\ndatos[datos == \"Computers Electronics and Technology > Social Media Networks\"] <- \"Computers Electronics and Technology\"\ndatos[datos == \"Computers Electronics and Technology > Telecommunications\"] <- \"Computers Electronics and Technology\"\ndatos[datos == \"Computers Electronics and Technology > Programming and Developer Software\"] <- \"Computers Electronics and Technology\"\ndatos[datos == \"Computers Electronics and Technology > Consumer Electronics\"] <- \"Computers Electronics and Technology\"\ndatos[datos == \"Computers Electronics and Technology > Other Computers Electronics and Technology\"] <- \"Computers Electronics and Technology\"\ndatos[datos == \"Arts & Entertainment > Streaming & Online TV\"] <- \"Arts & Entertainment\"\ndatos[datos == \"Arts & Entertainment > Animation and Comics\"] <- \"Arts & Entertainment\"\ndatos[datos == \"Arts & Entertainment > Other Arts and Entertainment\"] <- \"Arts & Entertainment\"\ndatos[datos == \"Reference Materials > Dictionaries and Encyclopedias\"] <- \"Reference Materials\"\ndatos[datos == \"eCommerce & Shopping > Marketplace\"] <- \"eCommerce & Shopping\"\ndatos[datos == \"Science and Education > Weather\"] <- \"Science and Education\"\ndatos[datos == \"Games > Video Games Consoles and Accessories\"] <- \"Games\"\ndatos[datos == \"Travel and Tourism > Accommodation and Hotels\"] <- \"Travel and Tourism\" \n\n\n\ndatos_2 <- datos %>% mutate(Category = forcats::as_factor(Category)) #- convertimos la v. category a factor con la f. as_factor()\ndatos_2 <- datos_2 %>% mutate(Category = forcats::fct_infreq(Category)) #- fct_infreq() los niveles del factor según su frecuencia de mayor a menor\np1 <- ggplot(datos_2, aes(fct_rev(Category))) \np1 <- p1 + geom_bar(fill = \"DarkCyan\") + xlab(\"Categoría de los sitios Web\") + ylab(\"Cantidad\") + coord_flip()\n\n\nplotly::ggplotly(p1)\n\n```\n\n\nLas categorías de páginas web más visitadas son \"electrónica y tecnología informática\", \"editores de noticias y medios de comunicación\" y páginas para adultos.\n\n## Subcategorías\n\n::: {.panel-tabset}\n\n## Subcategorías de las páginas web más visitadas\n\n```{r}\n#| code-fold: true\ndatos <- rio::import(\"./datos/df_1.csv\") \ncolnames(datos) <- as.character(datos[1,])\ndatos <- datos[-1,]\nnames(datos)[names(datos) == \"NA\"] <- \"Position\"\nnames(datos)[names(datos) == \"Principal country/territory\"] <- \"Country\"\ndatos$Position = datos$Position +1\n\ndatos <- datos %>%\n  separate(col = \"Category\",\n           into = paste0(\"Category\", 1:2), sep = \">\",\n           extra = \"merge\") %>%\n  drop_na()\n\ndatos_4 <- datos %>%\n  select(Category2, Category1) %>%\n  count(Category2, Category1) %>%\n  drop_na()\n\nnames(datos_4)[names(datos_4) == \"Category2\"] <- \"Subcategoría\"\nnames(datos_4)[names(datos_4) == \"Category1\"] <- \"Categoría\"\nnames(datos_4)[names(datos_4) == \"n\"] <- \"Cantidad\"\n\np3 <- ggplot(datos_4, aes(x = Subcategoría, y = Cantidad, color = Categoría)) + geom_point() + coord_flip()\n\np3 + transition_states(\n    Categoría,\n    transition_length = 2,\n    state_length = 10)\n\n\n```\n\nLa categoría más grande, \"Electrónica y tecnología informática\", incluye las páginas web de telecomunicaciones, redes sociales, motores de búsqueda, software de programación y desarrollo, correo electrónico y electrónica de consumo. Así pues, las más básicas páginas web, las que utilizamos a diario. La mayoría de la páginas están en la subcategoría de redes sociales.\n\nLa categoría \"Arte y Entretenimiento\" incluye la televisión en streaming y en línea y las animaciones y cómics.\n\n## Otra forma de considerar las subcategorías\n\n```{r}\n#| code-fold: true\np2 <- ggplot(datos_4, aes(x = Subcategoría, y = Cantidad)) + geom_point() + coord_flip()\n\np2 + facet_wrap(vars(Categoría),  nrow = 10, ncol = 10)\n\n```\n\n:::\n\n# Países de origen de las páginas web\n\n::: {.panel-tabset}\n\n## Con highcharter\n\n```{r}\n#| code-fold: true\n\ndatos <- rio::import(\"./datos/df_1.csv\") \ncolnames(datos) <- as.character(datos[1,])\ndatos <- datos[-1,]\nnames(datos)[names(datos) == \"NA\"] <- \"Position\"\nnames(datos)[names(datos) == \"Principal country/territory\"] <- \"Country\"\ndatos$Position = datos$Position +1\n\ndatos_3 <- datos %>%\n  select(Country) %>%\n  count(Country)\n\ndatos_3[datos_3 == \"Russia\"] <- \"Russian Federation\"\ndatos_3[datos_3 == \"South Korea\"] <- \"Republic of Korea\"\n\ndat <- iso3166\ndat <- rename(dat, \"iso-a3\" = a3)\n\nmapa <- full_join(dat, datos_3, by = c(\"ISOname\" = \"Country\"))\nmapa[is.na(mapa)] <- 0\nmapa <- mapa[-82,]\nmapa <- mapa[-48,]\n\nhcmap(\n  map = \"custom/world-highres3\", # high resolution world map\n  data = mapa, # name of dataset\n  joinBy = \"iso-a3\",\n  value = \"n\",\n  showInLegend = FALSE, # hide legend\n  download_map_data = TRUE\n) %>%\n  hc_mapNavigation(enabled = FALSE) %>%\n  hc_legend(\"none\") %>%\n  hc_title(text = \"Cantidad de páginas web por país de origen\") %>%\n  hc_colorAxis(minColor = \"#d1ebeb\", maxColor = \"#008b8b\")\n\n```\n\n## Con tmap\n\n```{r}\n#| code-fold: true\n\ndatos_3 <- datos %>%\n  select(Country) %>%\n  count(Country)\n\ndatos_3[datos_3 == \"Czech Republic\"] <- \"Czech Rep.\"\ndatos_3[datos_3 == \"South Korea\"] <- \"Korea\"\n\n\ndata(World) \nworld <- World ; rm(World)\n\n\nworld <- world %>% filter(continent != \"Antarctica\") %>% filter(name != \"Greenland\")\naa <- ggplot() + geom_sf(data = world) + theme_void()\nworld <- world %>% select(name, geometry)\n\nmap2 <- full_join(datos_3, world, by = c(\"Country\" = \"name\"))\n\nmap3 <- map2 %>% \n  ggplot + geom_sf (data = map2, aes(geometry = geometry , fill = n)) + scale_fill_viridis_c(option = \"mako\", trans = \"sqrt\") + labs(title = \"Cantidad de páginas web por país de origen\", subtitle = \"(más claro mayor, más oscuro menor)\") \n\nmap3\n\n```\n\n:::\n\nAquí vemos que los mapas están muy vacíos porque la mayoría de los sitios web más visitados del mundo proceden de EE.UU. (30), Rusia (5) y China (4). Podemos concluir que las potencias mundiales poseen casi todas las principales páginas web.\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"a11y","css":["my_styles.css"],"toc":true,"toc-depth":3,"embed-resources":true,"output-file":"my_trabajo_BigData.html"},"language":{},"metadata":{"lang":"es","fig-responsive":true,"quarto-version":"1.2.269","license":"CC BY","theme":"flatly","page-layout":"full","code-copy":true,"title":"Las páginas web más visitadas","description":"Viendo qué páginas web son las más visitadas, de qué categoría son y de dónde proceden\n","author":[{"name":"Adeline Baillifard (baillifa@alumni.uv.es)","affiliation":"Universitat de València","affiliation-url":"https://www.uv.es"}],"date":"2023-01-13","categories":["trabajo BigData"],"title-block-banner":false,"title-block-banner-color":"#FFFFFF","toc-location":"left","smooth-scroll":true,"backgroundcolor":"#f2f7f6"},"extensions":{"book":{"multiFile":true}}}}}